import _extends from"@babel/runtime/helpers/extends";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";import _classCallCheck from"@babel/runtime/helpers/classCallCheck";import _createClass from"@babel/runtime/helpers/createClass";import _possibleConstructorReturn from"@babel/runtime/helpers/possibleConstructorReturn";import _getPrototypeOf from"@babel/runtime/helpers/getPrototypeOf";import _inherits from"@babel/runtime/helpers/inherits";var _jsxFileName="/Users/trensik/dev/react-native-paper/src/components/TextInput/TextInput.tsx";import*as React from'react';import{Animated,TextInput as NativeTextInput,Platform}from'react-native';import TextInputOutlined from'./TextInputOutlined';import TextInputFlat from'./TextInputFlat';import{withTheme}from'../../core/theming';var BLUR_ANIMATION_DURATION=180;var FOCUS_ANIMATION_DURATION=150;var TextInput=function(_React$Component){_inherits(TextInput,_React$Component);function TextInput(){var _getPrototypeOf2;var _this;_classCallCheck(this,TextInput);for(var _len=arguments.length,_args=new Array(_len),_key=0;_key<_len;_key++){_args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(TextInput)).call.apply(_getPrototypeOf2,[this].concat(_args)));_this.state={labeled:new Animated.Value(_this.props.value||_this.props.error?0:1),error:new Animated.Value(_this.props.error?1:0),focused:false,placeholder:_this.props.error?_this.props.placeholder:'',value:_this.props.value||_this.props.defaultValue,labelLayout:{measured:false,width:0,height:0}};_this._showPlaceholder=function(){if(_this._timer){clearTimeout(_this._timer);}_this._timer=setTimeout(function(){return _this.setState({placeholder:_this.props.placeholder});},50);};_this._hidePlaceholder=function(){return _this.setState({placeholder:''});};_this._showError=function(){Animated.timing(_this.state.error,{toValue:1,duration:FOCUS_ANIMATION_DURATION,useNativeDriver:Platform.select({ios:false,default:true})}).start(_this._showPlaceholder);};_this._hideError=function(){Animated.timing(_this.state.error,{toValue:0,duration:BLUR_ANIMATION_DURATION,useNativeDriver:Platform.select({ios:false,default:true})}).start();};_this._restoreLabel=function(){return Animated.timing(_this.state.labeled,{toValue:1,duration:FOCUS_ANIMATION_DURATION,useNativeDriver:Platform.select({ios:false,default:true})}).start();};_this._minmizeLabel=function(){return Animated.timing(_this.state.labeled,{toValue:0,duration:BLUR_ANIMATION_DURATION,useNativeDriver:Platform.select({ios:false,default:true})}).start();};_this._handleFocus=function(args){if(_this.props.disabled||!_this.props.editable){return;}_this.setState({focused:true});if(_this.props.onFocus){_this.props.onFocus(args);}};_this._handleBlur=function(args){if(_this.props.disabled||!_this.props.editable){return;}_this.setState({focused:false});if(_this.props.onBlur){_this.props.onBlur(args);}};_this._handleChangeText=function(value){if(!_this.props.editable){return;}_this.setState({value:value});_this.props.onChangeText&&_this.props.onChangeText(value);};_this._onLayoutAnimatedText=function(e){_this.setState({labelLayout:{width:e.nativeEvent.layout.width,height:e.nativeEvent.layout.height,measured:true}});};return _this;}_createClass(TextInput,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps,prevState){if(prevState.focused!==this.state.focused||prevState.value!==this.state.value||prevProps.error!==this.props.error||this.props.defaultValue){if(this.state.value||this.state.focused||this.props.error){this._minmizeLabel();}else{this._restoreLabel();}}if(prevState.focused!==this.state.focused||prevProps.label!==this.props.label||prevProps.error!==this.props.error){if(this.state.focused||this.props.error||!this.props.label){this._showPlaceholder();}else{this._hidePlaceholder();}}if(prevProps.error!==this.props.error){if(this.props.error){this._showError();}else{this._hideError();}}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(this._timer){clearTimeout(this._timer);}}},{key:"setNativeProps",value:function setNativeProps(args){return this._root&&this._root.setNativeProps(args);}},{key:"isFocused",value:function isFocused(){return this._root&&this._root.isFocused();}},{key:"clear",value:function clear(){return this._root&&this._root.clear();}},{key:"focus",value:function focus(){return this._root&&this._root.focus();}},{key:"blur",value:function blur(){return this._root&&this._root.blur();}},{key:"render",value:function render(){var _this2=this;var _ref=this.props,mode=_ref.mode,rest=_objectWithoutProperties(_ref,["mode"]);return mode==='outlined'?React.createElement(TextInputOutlined,_extends({},rest,{parentState:this.state,innerRef:function innerRef(ref){_this2._root=ref;},onFocus:this._handleFocus,onBlur:this._handleBlur,onChangeText:this._handleChangeText,onLayoutAnimatedText:this._onLayoutAnimatedText,__source:{fileName:_jsxFileName,lineNumber:401}})):React.createElement(TextInputFlat,_extends({},rest,{parentState:this.state,innerRef:function innerRef(ref){_this2._root=ref;},onFocus:this._handleFocus,onBlur:this._handleBlur,onChangeText:this._handleChangeText,onLayoutAnimatedText:this._onLayoutAnimatedText,__source:{fileName:_jsxFileName,lineNumber:413}}));}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(nextProps,prevState){return{value:typeof nextProps.value!=='undefined'?nextProps.value:prevState.value};}}]);return TextInput;}(React.Component);TextInput.defaultProps={mode:'flat',dense:false,disabled:false,error:false,multiline:false,editable:true,render:function render(props){return React.createElement(NativeTextInput,_extends({},props,{__source:{fileName:_jsxFileName,lineNumber:174}}));}};export default withTheme(TextInput);
//# sourceMappingURL=TextInput.js.map